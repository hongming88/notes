# 面试

**那你可以跟我讲一下平时的SQL调优思路么**

首先呢，有条最基本的，表要有主键，因为有主键的表MySQL会创建聚簇索引，聚簇索引的好处是它的主键和数据行是在一行的，你在explain查询语句的时候会发现，它的type级别是const,这是很高的一种级别，然后，当有主键的时候
如果一条SQL语句很慢，可以去查看它是否建立了相应的索引，

建立索引要尽量选择where条件后面的字段，或者order by

还可以是group by或者是join连接的字段，作为你的索弱引列，这些索弱引列也要排个序，要符合最左匹配原则，你选的时候要根据它门的索引选择器，你的重复的数据行和重复的数据行中间的排列，大的放左小的放右这样的形式，这种多列的索引列，你要去建立联合索引而非单个索引，另外，你在SQL书写的时候，

不要将索引列放到一个表达式中，或者说你用了一些反向判断

比如NotNu1l、不等于、Noln等这种关键词，他会他你的索引失效。

还有一点，如果你的数据查询的非常频繁。可以考虑给他使用那种覆盖索引。覆盖索引是可以直接在索引中查询到数据的，相对来说还是很快的，关于你设计的索引没有生效，你也可以去考虑下是不是MySQL，因为一些其它的原因造成的，MySQL的底层，它有一个随机采样。它会根据你的索引基数，但不可能全都给你标记上，但它会根据随机来用来计算你索引基数是如何的，它有一个随机采样。它会根据你的索引基数，但不可能全都给你标记上，但它会根据随机采用来计算你索引基数是如何的，如果他采错了，虽然你的索引选择性比较大，但它认为你的索引选择性比较小，但它认为你的索引选择性比较小，可能不走你的索引。就走错索引。可通过加force index强制让它走该索引。然后看行不行。如果不行的话，你需刷新下的信息，要用analyze TABLES，看它有没有再重新组队，关于数据库调优现在能想到的就这些



## **在创建索引时创建唯一索引还是普通索引好点？**



因为唯一索引，它会去确保列的唯一，所以会多一次判断的过程，但它判断过程的开销是很小的，真正的开销的话是在它buffer区的，



## 其他

**==什么是聚簇索引？==**

聚簇索引是将数据存储与索引放到了一块，找到索引也就找到了数据



聚簇索引直接找到数据（例如id）



**==什么是非聚簇索引？==**

非聚簇索引是将数据与索引，分开存储，索引结构的叶子节点，指向了数据的对应行。

索引的存储和数据的存储是分离的，也就是说找到了索引但没找到数据，需要根据索引上的值(主键)再次回表查询,非聚簇索引也叫做辅助索引



非聚簇索引先找到聚簇索引再通过聚簇索引找到数据



**总结**

主键一定是聚簇索引，MySQL的InnoDB中一定有主键，即便研发人员不手动设置，则会使用unique索引，没有unique索引，则会使用数据库内部的一个行的id来当作主键索引,其它普通索引需要区分SQL场景，当SQL查询的列就是索引本身时，我们称这种场景下该普通索引也可以叫做聚簇索引，MyisAM引擎没有聚簇索引。



**force index()** 

https://blog.csdn.net/qq_39505065/article/details/89497754





**最左匹配原则：**最左优先，以最左边的为起点任何连续的索引都能匹配上。同时遇到范围查询(>、<、between、like)就会停止匹配。



最佳左前缀法则 - <font color="red">如果索引了多列，要遵守最左前缀法则。**指的是查询从索引的最左前列开始并且不跳过复合索引中间列。**</font>



回表

（1）先通过普通索引定位到主键值id=5；

（2）在通过聚集索引定位到行记录；

这就是所谓的**回表查询**，先定位主键值，再定位行记录，它的性能较扫一遍索引树更低。



索引回表就是指先读取索引键值，然后，再根据索引信息回到索引基表读取数据行的过程。